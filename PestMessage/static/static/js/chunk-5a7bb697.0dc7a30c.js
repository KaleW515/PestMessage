(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a7bb697"],{"337b":function(t,e,n){},"8a0e":function(t,e,n){"use strict";var a=n("337b"),s=n.n(a);s.a},b0c0:function(t,e,n){var a=n("83ab"),s=n("9bf2").f,i=Function.prototype,o=i.toString,l=/^\s*function ([^ (]*)/,r="name";!a||r in i||s(i,r,{configurable:!0,get:function(){try{return o.call(this).match(l)[1]}catch(t){return""}}})},ead1:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"messageBoard"}},[n("el-container",[n("el-header",{attrs:{id:"header"}},[t._v("留言板")]),n("div",{attrs:{id:"searchInput"}},[n("el-input",{attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchComments()}},model:{value:t.inputField,callback:function(e){t.inputField=e},expression:"inputField"}}),n("el-switch",{staticStyle:{"margin-top":"30px"},attrs:{"active-text":"按点赞数排序","inactive-text":"按时间排序"},on:{change:function(e){return t.init()}},model:{value:t.valueOpen,callback:function(e){t.valueOpen=e},expression:"valueOpen"}})],1),n("el-main",t._l(t.message,(function(e){return n("div",{key:e,staticClass:"text item"},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",staticStyle:{"padding-bottom":"50px"},attrs:{slot:"header"},slot:"header"},[n("div",{staticClass:"block"},[n("el-avatar",{staticClass:"myAva",attrs:{size:50,src:e.avaUrl}})],1),n("span",{staticClass:"msgTitle",domProps:{textContent:t._s(e.name+"     "+e.date)}}),n("el-link",{staticStyle:{left:"64%",position:"absolute","margin-top":"14px"},on:{click:function(n){return t.watchOldReply(e)}}},[t._v("查看回复"),n("i",{staticClass:"el-icon-view el-icon--right"})]),n("el-link",{staticStyle:{left:"75%",position:"absolute","margin-top":"14px"},attrs:{icon:"el-icon-edit"},on:{click:function(n){return t.reply(e)}}},[t._v("回复 ")]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点个赞",placement:"top-end"}},[n("i",{staticClass:"el-icon-thumb",on:{click:function(n){return t.incLikeNum(e)}}})]),n("span",{staticClass:"likeNum",domProps:{textContent:t._s(e.likenum)}}),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"踩一下",placement:"top-end"}},[n("i",{staticClass:"el-icon-toilet-paper",on:{click:function(n){return t.incDisLikeNum(e)}}})]),n("span",{staticClass:"disLikeNum",domProps:{textContent:t._s(e.dislikenum)}})],1),n("div",[n("span",{domProps:{textContent:t._s(e.content)}}),e.replyIsShow?n("div",{staticClass:"reply-box"},[n("ul",{staticClass:"infinite-list",staticStyle:{overflow:"auto"}},t._l(e.reply,(function(e){return n("li",{staticClass:"infinite-list-item"},[n("div",{staticClass:"block"},[n("el-avatar",{staticClass:"myAva",attrs:{size:30,src:e.avaUrl}})],1),n("span",{staticStyle:{"margin-left":"60px",color:"#EB7347"},domProps:{textContent:t._s(e.from_name)}}),n("span",{domProps:{textContent:t._s(": "+e.content+"       ("+e.date+")")}}),e.from_name===t.username?n("el-link",{attrs:{type:"primary",underline:!1},domProps:{textContent:t._s("   删除")},on:{click:function(n){return t.delMyReply(e)}}}):t._e()],1)})),0)]):t._e(),e.inputIsShow?n("el-input",{staticStyle:{top:"8px"},attrs:{rows:5,placeholder:"请输入回复内容,字数限制100字",minlength:"1",maxlength:"100",type:"textarea"},model:{value:t.newReply,callback:function(e){t.newReply=e},expression:"newReply"}}):t._e(),e.inputIsShow?n("el-button",{staticStyle:{left:"48%",position:"relative","margin-top":"20px"},attrs:{icon:"el-icon-check",type:"primary"},on:{click:function(n){return t.replyOver(e)}}}):t._e()],1)])],1)})),0)],1),n("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{background:"",layout:"prev, pager, next, jumper","current-page":t.currentPage,total:t.total},on:{"current-change":t.handleCurrentChange}})],1)},s=[],i=(n("b0c0"),{name:"MessageBoard",data:function(){return{valueOpen:!1,count:0,username:"",inputField:"",currentPage:1,total:0,dialogVisible:!1,newReply:"",message:[{id:0,from_phonenumber:"",likenum:0,dislikenum:0,avaUrl:"",content:"",date:"2020-02-23",name:"忧郁的小乌龟",reply:[]}]}},methods:{handleCurrentChange:function(t){this.currentPage=t;var e=this,n=new FormData;n.append("currentPage",e.currentPage),n.append("value",e.valueOpen),this.axios({method:"post",url:"/watchMoreComments",data:n}).then((function(t){"成功"===t.data.msg?(e.message=t.data.pageNow,e.total=10*parseInt(t.data.pageCount)):e.$message.error(t.data.msg)}),(function(t){console.log(t)}))},incLikeNum:function(t){var e=this,n=new FormData;n.append("commentsId",t.id),this.axios({method:"post",url:"/incLikeNum",data:n}).then((function(n){"点赞成功"===n.data.msg?t.likenum+=1:e.$message(n.data.msg)}),(function(t){console.log(t),e.$message.error("你还没登录呢")}))},incDisLikeNum:function(t){var e=this,n=new FormData;n.append("commentsId",t.id),this.axios({method:"post",url:"/incDisLikeNum",data:n}).then((function(n){"点踩成功"===n.data.msg?t.dislikenum+=1:e.$message(n.data.msg)}),(function(t){console.log(t),e.$message.error("你还没登录呢")}))},reply:function(t){t.inputIsShow=!0},watchOldReply:function(t){t.replyIsShow=!t.replyIsShow;var e=this,n=new FormData;n.append("commentsId",t.id),this.axios({method:"post",url:"/watchReply",data:n}).then((function(n){"没有回复"===n.data.msg?e.$message("没有回复"):t.reply=n.data}),(function(t){console.log(t)}))},replyOver:function(t){t.inputIsShow=!1;var e=this,n=new FormData,a=this.getNowFormatDate();n.append("content",this.newReply),0===this.newReply.length?this.$message({message:"你没有输入任何消息",type:"warning"}):(n.append("commentsId",t.id),n.append("date",a),this.axios({method:"post",url:"/writeReply",data:n}).then((function(n){var s=n.data.msg;if("评论成功"===s){var i=n.data.name,o={from_name:i,content:e.newReply,date:a};t.reply.push(o),e.$message({message:s,type:"success"}),e.newReply=""}else e.$message.error(s),e.newReply=""}),(function(t){console.log(t)})))},getNowFormatDate:function(){var t=new Date,e="-",n=t.getFullYear(),a=t.getMonth()+1,s=t.getDate();a>=1&&a<=9&&(a="0"+a),s>=0&&s<=9&&(s="0"+s);var i=n+e+a+e+s;return i},init:function(){var t=this,e=new FormData;e.append("value",this.valueOpen),this.axios({method:"post",url:"/watchComments",data:e}).then((function(e){t.message=e.data.pageNow,t.total=10*parseInt(e.data.pageCount),t.username=e.data.username}),(function(t){console.log(t)}))},searchComments:function(){var t=this,e=new FormData;e.append("inputField",this.inputField),this.axios({method:"post",url:"/searchComments",data:e}).then((function(e){console.log(e),t.message=e.data.pageNow}),(function(e){console.log(e),t.$message.error("没有结果")}))},delMyReply:function(t){var e=this;this.$confirm("此操作将永久删除该回复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.axios({methods:"get",url:"/delMyReply?id="+t.id}).then((function(t){e.$message({type:"success",message:"删除成功!"})}),(function(t){console.log(t)}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))}},mounted:function(){this.init()}}),o=i,l=(n("8a0e"),n("2877")),r=Object(l["a"])(o,a,s,!1,null,"5630d9f4",null);e["default"]=r.exports}}]);